(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[911],{125:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(8398),r=n(9008),i=n(2881),s=n(5080),o=n.n(s),l=n(5893);function c(e){var t=e.postData,n=e.children;return(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(r.default,{children:[(0,l.jsx)("title",{children:t.title}),(0,l.jsx)("script",{async:!0,src:"https://platform.twitter.com/widgets.js",charSet:"utf-8"})]}),(0,l.jsxs)("article",{className:"blog-post",children:[(0,l.jsx)("h1",{className:o().headingXl,children:t.title}),(0,l.jsx)("div",{className:o().lightText,children:(0,l.jsx)(i.Z,{dateString:t.date})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:t.contentHtml}}),n]})]})}},2881:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(3855),r=n(4790),i=n(5893);function s(e){var t=e.dateString,n=(0,a.Z)(t);return(0,i.jsx)("time",{dateTime:t,children:(0,r.Z)(n,"LLLL d, yyyy")})}},8398:function(e,t,n){"use strict";n.d(t,{y:function(){return d},Z:function(){return f}});var a=n(9008),r=n(5675),i=n(4608),s=n.n(i),o=n(5080),l=n.n(o),c=n(1664),h=n(5893),u="Pierre Hedkvist",d="Pierre Hedkvist";function f(e){var t=e.children,n=e.home;return(0,h.jsxs)("div",{className:s().container,children:[(0,h.jsxs)(a.default,{children:[(0,h.jsx)("link",{rel:"icon",href:"/favicon/favicon.ico"}),(0,h.jsx)("meta",{name:"description",content:"Learn how to build a personal website using Next.js"}),(0,h.jsx)("meta",{property:"og:image",content:"https://og-image.vercel.app/".concat(encodeURI(d),".png?theme=light&md=0&fontSize=75px&images=https%3A%2F%2Fassets.zeit.co%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg")}),(0,h.jsx)("meta",{name:"og:title",content:d}),(0,h.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,h.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/favicon/apple-touch-icon.png"}),(0,h.jsx)("link",{rel:"icon",type:"image/png",sizes:"32x32",href:"/favicon/favicon-32x32.png"}),(0,h.jsx)("link",{rel:"icon",type:"image/png",sizes:"16x16",href:"/favicon/favicon-16x16.png"}),(0,h.jsx)("link",{rel:"manifest",href:"/favicon/site.webmanifest"}),(0,h.jsx)("link",{rel:"mask-icon",href:"/favicon/safari-pinned-tab.svg",color:"#5bbad5"}),(0,h.jsx)("meta",{name:"msapplication-TileColor",content:"#00aba9"}),(0,h.jsx)("meta",{name:"theme-color",content:"#ffffff"})]}),(0,h.jsx)("header",{className:s().header,children:n?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(r.default,{priority:!0,src:"/images/me.png",className:l().borderCircle,height:144,width:144,alt:u}),(0,h.jsx)("h1",{className:l().heading2Xl,children:u})]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.default,{href:"/",children:(0,h.jsx)("a",{children:(0,h.jsx)(r.default,{priority:!0,src:"/images/me.png",className:l().borderCircle,height:108,width:108,alt:u})})}),(0,h.jsx)("h2",{className:l().headingLg,children:(0,h.jsx)(c.default,{href:"/",children:(0,h.jsx)("a",{className:l().colorInherit,children:u})})})]})}),(0,h.jsx)("main",{children:t}),!n&&(0,h.jsx)("div",{className:s().backToHome,children:(0,h.jsx)(c.default,{href:"/",children:(0,h.jsx)("a",{children:"\u2190 Back to home"})})})]})}},7949:function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(a=n.next()).done)&&(i.push(a.value),!t||i.length!==t);s=!0);}catch(l){o=!0,r=l}finally{try{s||null==n.return||n.return()}finally{if(o)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.r(t),n.d(t,{__N_SSG:function(){return h},default:function(){return u},postData:function(){return g}});var i=n(4651),s=n(7294),o=n(125),l=n(5893);function c(e,t,n,a){var r=(0,i.useRouter)(),o=r.query[t],l=o&&"string"===typeof o?o:void 0,c=(0,s.useState)(l?a(l):e),h=c[0],u=c[1];(0,s.useEffect)((function(){l&&a(l)!==h&&u(a(l))}),[l]);return[h,function(e){u(e),r.query[t]=n(e),r.push(r,void 0,{shallow:!0})}]}var h=!0;function u(e){var t=e.postData,n=r(c(!1,"boolean",(function(e){return e?"true":"false"}),(function(e){return"true"===e})),2),a=n[0],i=n[1],s=r(c(10,"slider",(function(e){return e.toString()}),(function(e){return Number(e)!==Number.NaN?Number(e):10})),2),h=s[0],u=s[1];return(0,l.jsx)(o.Z,{postData:t,children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("a",{href:"https://en.wikipedia.org/wiki/Deep_linking",target:"_blank",children:"Deep linking"})," ","is a fundamental part of the web. It makes it possible to share links to pages with specific information. Take this link for instance:"," ",(0,l.jsx)("a",{href:"https://www.google.com/search?q=react",target:"_blank",children:"https://www.google.com/search?q=react"}),". It contains a query parameter, that contains the key q, and value react. Upon entering the page, a google search page will appear with results for the given keyword."]}),(0,l.jsx)("p",{children:"You can also think of a UI that can contain several filters. After you have spent time setting up your desired filter, you might accidentally close the window. Then re-opening the site, you have to go trough the hassle of setting up the filter all over again \ud83d\ude2c. This happens because the site doesn't save the filter anywhere. If the site did put the all filter settings in the URL, this wouldn't be a problem."}),(0,l.jsx)("p",{children:"Try changing the inputs below, and look at the URL."}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"bool",children:"Checkbox"}),(0,l.jsx)("input",{type:"checkbox",name:"bool",checked:a,onChange:function(){return i(!a)}})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"volume",children:"Slider"}),(0,l.jsx)("input",{type:"range",id:"volume",name:"volume",min:"0",max:"100",value:h,onChange:function(e){return u(Number(e.target.value))}})]}),(0,l.jsx)("p",{children:"Now refresh the page. \ud83d\ude03"}),(0,l.jsx)("p",{children:"A tweet by Kent C. Doods highlights this type of issue, and propose that you should treat the url as the source of state, and ditching the local state in return."}),(0,l.jsxs)("blockquote",{className:"twitter-tweet",children:[(0,l.jsx)("p",{lang:"en",dir:"ltr",children:"If you find yourself synchronizing some local component state with the URL (for example, query parameters), you'd be better off treating the URL as the source of truth and ditching your local state in favor of getting the value from the URL (or your router) and updating the URL."}),"\u2014 Kent C. Dodds \ud83d\udcbf (@kentcdodds)"," ",(0,l.jsx)("a",{href:"https://twitter.com/kentcdodds/status/1349173470567964673?ref_src=twsrc%5Etfw",children:"January 13, 2021"})]}),(0,l.jsxs)("p",{children:["I have found several hooks that makes it easy to implement this. Alibaba has a collection of React hooks, one called ",(0,l.jsx)("strong",{children:"useUrlState"})," which you start using directly"," ",(0,l.jsx)("a",{href:"https://ahooks.js.org/hooks/use-url-state/",target:"_blank",children:"here"}),". I decided to use these as inspiration for a hook I made myself. It looks like this."]}),(0,l.jsx)("pre",{children:(0,l.jsx)("code",{className:"language-typescript",children:d})}),(0,l.jsx)("p",{children:"It has four parameters. The first is the initial state of the hook. The second parameter is the name of the query param that will be shown in the url. The third function is a serialization function, that will take the state and turn it into a url friendly string. The fourth de-serialization function, will take the string and transform it back to the state. In the fourth step, its a good practice to make sure that the value is of correct type, since you don't want the rest of you application to fail because of invalid query params. You can extend the above hook to have more complicated types of query parameters that fit your needs. The one above is designed using react-router. But it could be used with other routing libraries as well."}),(0,l.jsx)("p",{children:"The slider and the checkbox can then be used in the following way."}),(0,l.jsx)("pre",{children:(0,l.jsx)("code",{className:"language-typescript",children:f})})]})})}var d="function useStateParams<T>(\n  initialState: T,\n  paramsName: string,\n  serialize: (state: T) => string,\n  deserialize: (state: string) => T\n): [T, (state: T) => void] {\n  const history = useHistory();\n  const search = new URLSearchParams(history.location.search);\n\n  const existingValue = search.get(paramsName);\n  const [state, setState] = useState<T>(\n    existingValue ? deserialize(existingValue) : initialState\n  );\n\n  useEffect(() => {\n    // Updates state when user navigates backwards or forwards in browser history\n    if (existingValue && deserialize(existingValue) !== state) {\n      setState(deserialize(existingValue));\n    }\n  }, [existingValue]);\n\n  const onChange = (s: T) => {\n    setState(s);\n    const searchParams = new URLSearchParams(history.location.search);\n    searchParams.set(paramsName, serialize(s));\n    const pathname = history.location.pathname;\n    history.push({ pathname, search: searchParams.toString() });\n  };\n\n  return [state, onChange];\n}",f="\nconst [bool, setBool] = useStateParams(\n  false,\n  'boolean',\n  (s) => (s ? 'true' : 'false'),\n  (s) => s === 'true'\n);\n\nconst [slider, setSlider] = useStateParams(\n  10,\n  'slider',\n  (s) => s.toString(),\n  (s) => (Number(s) !== Number.NaN ? Number(s) : 10)\n);\n",g={id:"react-state-url",title:"Storing state in the URL with React",date:"2022-03-11"}},5602:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/posts/react-state-url",function(){return n(7949)}])},4608:function(e){e.exports={container:"layout_container__2t4v2",header:"layout_header__2rhWq",backToHome:"layout_backToHome__1vZsp"}},5080:function(e){e.exports={heading2Xl:"utils_heading2Xl__1I65m",headingXl:"utils_headingXl__1XecN",headingLg:"utils_headingLg__de7p0",headingMd:"utils_headingMd__3de6G",borderCircle:"utils_borderCircle__13qdJ",colorInherit:"utils_colorInherit__3Gudf",padding1px:"utils_padding1px__oCny8",list:"utils_list__S7_pe",listItem:"utils_listItem__2eJpJ",lightText:"utils_lightText__12Ckm",alignCenter:"utils_alignCenter__1RvJP",social:"utils_social__2aDtk"}}},function(e){e.O(0,[247,522,774,888,179],(function(){return t=5602,e(e.s=t);var t}));var t=e.O();_N_E=t}]);