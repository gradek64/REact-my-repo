<!DOCTYPE html>
<!-- saved from url=(0055)https://www.codemzy.com/blog/get-set-query-params-react -->
<html lang="en" class="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Get and set query params with React Router (+ custom hook) - Codemzy's Blog</title><meta name="description" content="I created a custom hook to get and set query parameters in the URL query string using React Router and its location object. Here&#39;s how (and why) I built it, with all the code you need to use it."><meta name="viewport" content="initial-scale=1,width=device-width"><link href="./Get and set query params with React Router (+ custom hook) - Codemzy&#39;s Blog_files/styles.min.css" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com/"><link href="./Get and set query params with React Router (+ custom hook) - Codemzy&#39;s Blog_files/css2" rel="stylesheet"><link rel="shortcut icon" type="image/x-icon" href="https://codemzy.github.io/img/favicon.ico"><script src="./Get and set query params with React Router (+ custom hook) - Codemzy&#39;s Blog_files/darkmode.min.js"></script><link rel="canonical" href="https://www.codemzy.com/blog/get-set-query-params-react"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@codemzy"><meta property="og:url" content="https://www.codemzy.com/blog/get-set-query-params-react"><meta property="og:title" content="Get and set query params with React Router (+ custom hook)"><meta property="og:description" content="I created a custom hook to get and set query parameters in the URL query string using React Router and its location object. Here&#39;s how (and why) I built it, with all the code you need to use it."><meta property="og:image" content="https://assets.codemzy.com/logo/codemzy-face.png"><link href="./Get and set query params with React Router (+ custom hook) - Codemzy&#39;s Blog_files/prism.min.css" rel="stylesheet"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.codemzy.com/blog/get-set-query-params-react"},"headline":"Get and set query params with React Router (+ custom hook)","image":["https://assets.codemzy.com/logo/codemzy-face.png"],"datePublished":"2023-06-26T16:00:00Z","dateModified":"2023-06-26T16:00:00Z","author":{"@type":"Person","name":"Codemzy","url":"https://www.codemzy.com/blog/author/codemzy"},"publisher":{"@type":"Organization","name":"Codemzy","logo":{"@type":"ImageObject","url":"https://assets.codemzy.com/logo/codemzy-face.png"}},"description":"I created a custom hook to get and set query parameters in the URL query string using React Router and its location object. Here's how (and why) I built it, with all the code you need to use it."}</script></head><body class="flex flex-col min-h-screen text-gray-900 dark:bg-gray-900 dark:text-gray-200"><nav class="flex items-center flex-wrap p-5"><a href="https://www.codemzy.com/" class="font-bold mr-5 text-2xl inline-flex items-center uppercase">Codemzy</a><div class="ml-auto"><div class="relative inline-block"><a href="https://www.codemzy.com/blog/rss.xml" target="_blank" class="h-12 w-12 p-1 inline-flex items-center justify-center rounded-full focus:outline-none hover:text-gray-700 dark:hover:text-white focus:bg-gray-100 dark:focus:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" aria-label="RSS Icon" fill="currentColor" stroke="none" width="28" height="28" class="inline-block" viewBox="0 0 24 24"><path d="M3 3C12.9411 3 21 11.0589 21 21H18C18 12.7157 11.2843 6 3 6V3ZM3 10C9.07513 10 14 14.9249 14 21H11C11 16.5817 7.41828 13 3 13V10ZM3 17C5.20914 17 7 18.7909 7 21H3V17Z"></path></svg></a></div><div class="relative inline-block"><button id="button-dark-mode" class="h-12 w-12 p-1 inline-flex items-center justify-center rounded-full focus:outline-none hover:text-gray-700 dark:hover:text-white focus:bg-gray-100 dark:focus:bg-gray-800"><svg xmlns="http://www.w3.org/2000/svg" aria-label="Sun Icon" fill="currentColor" stroke="none" width="30" height="30" class="inline-block" viewBox="0 0 20 20" id="light-mode-icon"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-label="Moon Icon" fill="currentColor" stroke="none" width="30" height="30" class="inline-block" viewBox="0 0 20 20" id="dark-mode-icon"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button></div></div></nav><div class="p-5 break-words"><div class="max-w-3xl mx-auto my-10"><p class="py-5 flex items-center font-semibold text-lg md:text-xl"><a href="https://www.codemzy.com/blog">Blog</a><svg xmlns="http://www.w3.org/2000/svg" aria-label="Chevron Right Icon" fill="currentColor" stroke="none" width="20" height="20" class="inline-block" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg><a href="https://www.codemzy.com/blog/react">ReactJS</a></p><h1 class="text-4xl md:text-5xl lg:text-6xl font-bold leading-snug md:leading-snug lg:leading-snug">Get and set query params with React Router (+ custom hook)</h1><p class="md:text-lg py-10 prose dark:prose-dark">Written <span>by <a href="https://www.codemzy.com/blog/author/codemzy">Codemzy</a></span> on June 26th, 2023</p></div><div><div class="max-w-3xl mx-auto"><p class="text-lg lg:text-xl font-semibold">I created a custom hook to get and set query parameters in the URL query string using React Router and its location object. Here's how (and why) I built it, with all the code you need to use it.</p><article class="prose lg:prose-lg dark:prose-dark max-w-none my-10"><p>Today I was re-building a search component with ReactJS for a team page. When you navigate to the team page, you would see everyone on your team. And you could search by name or some other filter.</p> <p>The search worked, but once you clicked on a result (a team member) if you clicked the back button in the browser, you would go back to all results (rather than the filtered search results).</p> <p>Which didn't feel right.</p> <p>I'm going to talk more about building the search component in another blog post, for this post, all you need to know is - I solved this issue using query parameters. </p> <p>I build a custom (reusable) hook so I can use it for any component that needs to interact with query params in the future.</p> <h2 id="why-use-query-params-with-react-router">Why use query params with React Router</h2> <p>Go search "query params" in Google and you will see in the address bar that a query string has been added to the URL.</p> <pre><code>https://www.google.co.uk/search?q=query+params
</code></pre> <p><em>Anything after the <code>?</code> is your query string - in this case <code>q=query+params</code>.</em></p> <p>I've never really been a heavy user of query parameters in the web apps I've built. I learned to code when JavaScript frameworks (especially single-page applications like React) were getting popular, and I would handle state in Redux, React State or React Context.</p> <p>But I'm starting the learn that query params are so useful, especially for actions like search, that might keep you on the same page but show different contexts depending on values the user inputs.</p> <p>If the values are stored in the component state, when the user navigates away from the component, the previous values are gone. But if they are stored as key-value pairs in a query string on the URL, then going back in the browser can restore the previous values.</p> <p>We just need to set and get the query parameters!</p> <h2 id="setting-query-params">Setting query params</h2> <p>In React Router, location represents where the app is. We don't want to change the location path, but we do want to add query params to the URL. In React Router, this is at <code>location.search</code>.</p> <p>You can use the <code>useHistory</code> hook to navigate, and this will store the query string in the browser history (so the browser back button works).</p> <pre><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span>

<span class="token keyword">function</span> <span class="token function">SearchComponent</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// updates the query params</span>
  <span class="token keyword">function</span> <span class="token function">setQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      search<span class="token operator">:</span> <span class="token string">"?page=1&amp;text=john"</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>That works great, but we don't want to hard code the query string <code>"?page=1&amp;text=john"</code> since it needs to take real data. Ideally, I'd like to pass it an object of params and they get turned into a query string by magic (or code).</p> <p>Now, you can use <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank" rel="noopener"><code>URLSearchParams</code></a> for this, but it's not supported in Internet Explorer which some people do still use 🙄, so for peace of mind I created a function to get it done.</p> <pre><code class="language-js"><span class="token comment">// creates a query string from query object</span>
<span class="token keyword">function</span> <span class="token function">createQueryString</span><span class="token punctuation">(</span><span class="token parameter">queryObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> queryString <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>queryObject<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>queryObject<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> queryString <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">?</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>queryString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>It will <code>.filter()</code> out any empty values or arrays, and turn the rest into a query string.</p> <p>Let's see it in action!</p> <pre><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">createQueryString</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">"john"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "?page=1&amp;text=john"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">createQueryString</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">""</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "?page=1"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">createQueryString</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">"hr"</span><span class="token punctuation">,</span> <span class="token string">"accounts"</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "?page=1&amp;department=hr&amp;department=accounts"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">createQueryString</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// "?page=1"</span></code></pre><p>We can pass an object to <code>setQueryParams</code>, and using the <code>createQueryString</code> function, turn it onto query params in the address bar. Nice!</p> <pre><code class="language-js"><span class="token comment">// updates the query params</span>
<span class="token keyword">function</span> <span class="token function">setQueryParams</span><span class="token punctuation">(</span><span class="token parameter">queryObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    search<span class="token operator">:</span> <span class="token function">createQueryString</span><span class="token punctuation">(</span>queryObj<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2 id="getting-query-params">Getting query params</h2> <p>Now we can use <code>setQueryParams</code> to set the query string, but our component will also need to get the query string, and turn it back into our query object, so when we navigate our component knows what values to use.</p> <p>We can <code>useLocation</code> to do this, and get the <code>search</code> from the location object.</p> <pre><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useLocation<span class="token punctuation">,</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span>

<span class="token keyword">function</span> <span class="token function">SearchComponent</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> search <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// get the search (query string) from the location</span>

  <span class="token comment">// check if existing search</span>
  <span class="token keyword">const</span> queryParams <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> search<span class="token punctuation">,</span> <span class="token punctuation">[</span>search<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p><em>It's in <a href="https://react.dev/reference/react/useMemo" target="_blank" rel="noopener"><code>useMemo()</code></a> so the <code>queryParams</code> object only updates when <code>location.search</code> changes in <code>useLocation()</code>. Useful if the changing query parameters trigger API calls.</em></p> <p>This gets us the query string e.g. <code>"?page=1&amp;text=john"</code>, but of course, we want to parse that back into an object.</p> <p>Again, you could use <a href="https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams" target="_blank" rel="noopener"><code>URLSearchParams</code></a> for this, but I created a custom function for my own use. </p> <pre><code class="language-js"><span class="token comment">// turns query string back into an object</span>
<span class="token keyword">function</span> <span class="token function">queryStringToObject</span><span class="token punctuation">(</span>queryString <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> queryObject <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  queryString <span class="token operator">&amp;&amp;</span> <span class="token function">decodeURIComponent</span><span class="token punctuation">(</span>queryString<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">itemString</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>itemKey<span class="token punctuation">,</span> itemValue<span class="token punctuation">]</span> <span class="token operator">=</span> itemString<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>itemKey<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>queryObject<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        queryObject<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>options<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> queryObject<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>itemValue<span class="token punctuation">)</span> <span class="token operator">:</span> queryObject<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> options<span class="token punctuation">[</span>itemKey<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"number"</span> <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>itemValue<span class="token punctuation">)</span> <span class="token operator">:</span> itemValue<span class="token punctuation">;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> queryObject<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>It works like this:</p> <pre><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">queryStringToObject</span><span class="token punctuation">(</span><span class="token string">"?page=1&amp;department=hr&amp;department=accounts"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// {</span>
<span class="token comment">//   page: 1, </span>
<span class="token comment">//   department: ['hr', 'accounts']</span>
<span class="token comment">// }</span></code></pre><p>The <code>queryStringToObject</code> function takes a query string and an options object that tells it the default values (if no values are in the query string) - this is needed so the function knows the type of value. Which is especially useful when we want to use arrays or number values.</p> <p>For example, if there was only one <code>department</code> key-value pair in the query string, I would still want to get an array back, rather than a string, because that data needs to be an array.</p> <pre><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">queryStringToObject</span><span class="token punctuation">(</span><span class="token string">"?page=1&amp;department=hr"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// {</span>
<span class="token comment">//   page: 1, </span>
<span class="token comment">//   department: ['hr']</span>
<span class="token comment">// }</span></code></pre><p>Now we can update the <code>useMemo</code> hook to use the <code>queryStringToObject</code> function.</p> <pre><code class="language-js"><span class="token keyword">const</span> queryParams <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">queryStringToObject</span><span class="token punctuation">(</span>search<span class="token punctuation">,</span> <span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>search<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="the-usequeryparams-custom-hook">The <code>useQueryParams</code> custom hook</h2> <p>Now I can set and get query params, let's move this into a custom hook that can be used by any component in the future.</p> <p>I call it <code>useQueryParams.hook.js</code>!</p> <pre><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useLocation<span class="token punctuation">,</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span>
<span class="token comment">// utils</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createQueryString<span class="token punctuation">,</span> queryStringToObject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./helpers'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useQueryParams</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> search <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// get query params</span>
  <span class="token keyword">const</span> queryParams <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">queryStringToObject</span><span class="token punctuation">(</span>search<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>search<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// updates the query params</span>
  <span class="token keyword">function</span> <span class="token function">setQueryParams</span><span class="token punctuation">(</span><span class="token parameter">queryObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      search<span class="token operator">:</span> <span class="token function">createQueryString</span><span class="token punctuation">(</span>queryObj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> queryParams<span class="token punctuation">,</span> setQueryParams <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useQueryParams<span class="token punctuation">;</span></code></pre><p><em>Don't forget to include the <code>createQueryString</code> and <code>queryStringToObject</code> functions, or import them from a different file like I have done above.</em></p> <p>Now I can use the custom hook in any React component where I need to get or set the query params. Here's how that looks in my search component.</p> <pre><code class="language-js"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useQueryParams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./hooks/useQueryParams.hook.js'</span>

<span class="token keyword">function</span> <span class="token function">SearchComponent</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> queryParams<span class="token punctuation">,</span> setQueryParams <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span> page<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> department<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// api call</span>
  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">searchAPI</span><span class="token punctuation">(</span>queryParams<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">results</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// do something with the search results</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>queryParams<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  
  <span class="token comment">// updates the query params</span>
  <span class="token keyword">function</span> <span class="token function">handleSearch</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> title<span class="token punctuation">,</span> department <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">{</span> 
      <span class="token operator">...</span><span class="token punctuation">(</span>title <span class="token operator">&amp;&amp;</span> <span class="token punctuation">{</span> title <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token operator">...</span><span class="token punctuation">(</span>department <span class="token operator">&amp;&amp;</span> <span class="token punctuation">{</span> department <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Hopefully, this shows how the hook works. When <code>handleSearch</code> is called, e.g. from a search input by the user, a search object is created (in this example, with the keys <code>title</code> and/or <code>department</code> but any keys can be used as needed for your use case). </p> <p>The values get added as the query string to the location, by <code>setQueryParams</code>, which will then update <code>queryParams</code> and trigger a fresh API call. You can replace that <code>useEffect</code> with a <code>useQuery</code> if you are using <a href="https://tanstack.com/query/latest/docs/react/overview" target="_blank" rel="noopener">React Query</a> to manage server state.</p> </article></div></div></div><footer class="px-5 py-10 mt-auto text-sm"><div class="text-center"><a href="https://www.codemzy.com/" class="font-semibold">Codemzy</a> © 2023</div></footer></body></html>